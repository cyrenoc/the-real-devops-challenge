pipeline {

    agent any

    environment {
	PASS = credentials('registry-pass')
    }

    stages {

        stage('Build') {
            steps {
		     sh "echo hola build"
                     sh "pip install tox"
                     //sh "sudo apt-get install -y python-virtualenv virtualenv"
                     sh "pip3 install virtualenv"
                     sh "virtualenv -p python3 .venv"	   
                     sh "source .venv/bin/activate"
                     sh "pip install -r requirements.txt"
                    }
		}
		stage('Test') {
            steps {
		      //sh './jenkins/test/test.sh mvn test' 
                   sh "echo hola test"
                   sh "docker run  -v /home/ubuntu/jenkins/the-real-devops-challenge:/tmp/app -w /tmp/app --rm painless/tox /bin/bash tox"
                  }
		}
		
        stage('Deploy') {
            steps {
       		   //sh './jenkins/deploy/deploy.sh'
                   sh "echo hola deploy"
            }
         }
    }
}

